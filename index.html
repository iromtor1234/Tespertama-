<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gunung Key Access</title>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<style>
  html, body {
    margin: 0; padding: 0;
    font-family: sans-serif;
    background: url('https://i.ibb.co/9q5PjS6/mountain-bg.png') no-repeat center center / cover;
    height: 100%; overflow: hidden;
  }
  #toggleMenuBtn {
    position: fixed; top: 10px; right: 10px;
    z-index: 10;
    font-size: 24px;
    background: rgba(255,255,255,0.3);
    border: none; border-radius: 4px;
    padding: 5px 10px;
  }
  #adminBtn {
    position: fixed; bottom: 10px; right: 10px;
    z-index: 10;
    font-size: 14px;
    background: rgba(255,255,255,0.3);
    border: none; border-radius: 4px;
    padding: 5px 10px;
  }
  #slideMenu {
    position: fixed;
    right: -260px; top: 50%; transform: translateY(-50%);
    width: 250px; background: rgba(0,0,0,0.7);
    padding: 10px; border-radius: 8px;
    transition: right 0.3s;
    z-index: 9;
  }
  #slideMenu.open { right: 50%; transform: translate(50%,-50%); }
  input, button {
    width: 100%; padding: 8px; margin: 5px 0;
    border: none; border-radius: 4px; font-size: 1em;
  }
  #keyBox, #errorBox {
    padding: 5px; margin: 5px 0; border-radius: 4px;
  }
  #keyBox { background: rgba(0,0,0,0.5); color: #fff; }
  #errorBox { background: rgba(255,0,0,0.5); color: #fff; }
  #copyBtn { display: none; }
</style>
</head>
<body>

<button id="toggleMenuBtn">üè†</button>
<button id="adminBtn">Admin Access</button>

<div id="slideMenu">
  <h3>Password</h3>
  <input type="password" id="passwordInput" placeholder="Masukkan Password">
  <button id="togglePwBtn">üëÅ</button>
  <button id="generateBtn">Get Key</button>
  <button id="buyKeyBtn">Buy Key</button>
  <div id="spinner" style="display:none;">‚è≥ Loading...</div>
  <div id="keyBox" style="display:none;"></div>
  <div id="errorBox" style="display:none;"></div>
  <button id="copyBtn">Salin Key</button>
</div>

<script>
// Firebase setup
const firebaseConfig = {
  apiKey: "AIzaSyCldtyF1JSvBo4eBVBlYdI9pDAwM42Rb4M",
  authDomain: "rullweb.firebaseapp.com",
  databaseURL: "https://rullweb-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "rullweb",
  storageBucket: "rullweb.firebasestorage.app",
  messagingSenderId: "69407076508",
  appId: "1:69407076508:web:2f06036ef3785c65bb7d59"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let wrongAttempts = 0, isBlocked = false;

// Toggle menu
toggleMenuBtn.onclick = () => {
  slideMenu.classList.toggle("open");
};

// Toggle password visibility
togglePwBtn.onclick = () => {
  if (passwordInput.type === "password") {
    passwordInput.type = "text";
    togglePwBtn.textContent = "üôà";
  } else {
    passwordInput.type = "password";
    togglePwBtn.textContent = "üëÅ";
  }
};

// Generate key
generateBtn.onclick = () => {
  if (isBlocked) return;
  const pw = passwordInput.value.trim();
  if (!pw) return alert("Isi password!");
  showSpinner(true);
  db.ref("visitorCount").transaction(c => (c || 0) + 1);
  db.ref("keys").orderByChild("password").equalTo(pw).once("value", snap => {
    showSpinner(false);
    if (snap.exists()) {
      const data = Object.values(snap.val())[0];
      showKey(`Password: ${pw}\nKey: ${data.key}`);
      wrongAttempts = 0;
    } else {
      wrongAttempts++;
      showError("‚ùå Password salah!");
      if (wrongAttempts >= 3) {
        isBlocked = true;
        showError("‚ö†Ô∏è Salah 3x! Tunggu 10 detik...");
        disableInputs(true);
        setTimeout(() => {
          isBlocked = false;
          wrongAttempts = 0;
          disableInputs(false);
          hideError();
        }, 10000);
      }
    }
  });
};

// Copy key
copyBtn.onclick = () => {
  navigator.clipboard.writeText(keyBox.textContent).then(() => alert("‚úÖ Key disalin!"));
};

// Buy key
buyKeyBtn.onclick = () => window.open("https://t.me/ARullReal", "_blank");

// Admin access
adminBtn.onclick = () => {
  const pw = prompt("Masukkan password admin:");
  if (pw !== "RullAdmin") return alert("‚ùå Salah password admin!");
  db.ref("visitorCount").once("value", s => {
    alert(`üë• Visitor: ${s.val() || 0}`);
  });
  db.ref("keys").once("value", s => {
    let msg = "üîë Key list:\n";
    s.forEach(c => {
      const d = c.val();
      msg += `${d.password} : ${d.key}\n`;
    });
    alert(msg);
  });
};

function showSpinner(s) {
  spinner.style.display = s ? "block" : "none";
}
function showKey(t) {
  keyBox.textContent = t;
  keyBox.style.display = "block";
  copyBtn.style.display = "block";
}
function showError(t) {
  errorBox.textContent = t;
  errorBox.style.display = "block";
}
function hideError() {
  errorBox.style.display = "none";
}
function disableInputs(b) {
  generateBtn.disabled = b;
  passwordInput.disabled = b;
}
</script>

</body>
</html>
