<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RGB Slide Key Generator</title>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<style>
  html, body {
    margin: 0; padding: 0;
    font-family: sans-serif;
    overflow: hidden;
    height: 100%;
    background: black;
    color: #fff;
  }
  canvas {
    position: fixed; top:0; left:0;
    width: 100%; height: 100%;
    z-index: -1;
  }
  #slideMenu {
    position: fixed;
    right: -260px; top: 0;
    width: 250px; height: 100%;
    background: rgba(0,0,0,0.85);
    transition: right 0.3s;
    padding: 10px;
    overflow-y: auto;
    z-index: 10;
  }
  #slideMenu.open { right: 0; }
  #toggleMenuBtn {
    position: fixed; top:10px; right:10px;
    padding: 8px 12px;
    background: rgba(255,255,255,0.2);
    border: none; border-radius: 4px;
    z-index: 11;
  }
  input, button {
    width: 100%; padding: 8px;
    margin: 5px 0;
    border: none; border-radius: 4px;
    font-size: 1em;
  }
  #keyBox, #errorBox {
    padding: 5px;
    margin: 5px 0;
    border-radius: 4px;
  }
  #keyBox { background: rgba(0,0,0,0.5); }
  #errorBox { background: rgba(255,0,0,0.5); }
  #adminPanel {
    background: rgba(0,0,0,0.7);
    padding: 10px;
    border-radius: 4px;
    display: none;
    max-height: 80%;
    overflow-y: auto;
  }
</style>
</head>
<body>
<canvas id="bg"></canvas>
<button id="toggleMenuBtn">‚ò∞</button>
<div id="slideMenu">
  <h3>Masukkan Password</h3>
  <input type="password" id="passwordInput" placeholder="Password">
  <button id="togglePwBtn">üëÅ</button>
  <button id="generateBtn">Get Key</button>
  <button id="buyKeyBtn">Buy Key</button>
  <div id="spinner" style="display:none;">‚è≥ Loading...</div>
  <div id="keyBox" style="display:none;"></div>
  <div id="errorBox" style="display:none;"></div>
  <button id="copyBtn" style="display:none;">Salin Key</button>
  <hr>
  <button id="adminBtn">Access Admin</button>
  <div id="adminPanel"></div>
</div>

<script>
// Firebase
const firebaseConfig = {
  apiKey: "AIzaSyCldtyF1JSvBo4eBVBlYdI9pDAwM42Rb4M",
  authDomain: "rullweb.firebaseapp.com",
  databaseURL: "https://rullweb-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "rullweb",
  storageBucket: "rullweb.firebasestorage.app",
  messagingSenderId: "69407076508",
  appId: "1:69407076508:web:2f06036ef3785c65bb7d59"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let wrongAttempts = 0, isBlocked = false, entryCount = 0;

// Background RGB
const c = document.getElementById("bg"), ctx = c.getContext("2d");
c.width = innerWidth; c.height = innerHeight;
window.onresize = () => { c.width = innerWidth; c.height = innerHeight; };
let hue = 0;
function drawBG(){
  ctx.fillStyle = `hsl(${hue},100%,50%)`;
  ctx.fillRect(0,0,c.width,c.height);
  hue = (hue+0.5)%360;
  requestAnimationFrame(drawBG);
}
drawBG();

// Menu toggle
toggleMenuBtn.onclick = () => {
  slideMenu.classList.toggle("open");
};

// Actions
generateBtn.onclick = () => {
  if(isBlocked) return;
  const pw = passwordInput.value.trim();
  if(!pw) return alert("Isi password!");
  showSpinner(true);
  db.ref("visitorCount").transaction(c=>(c||0)+1);
  db.ref("keys").orderByChild("password").equalTo(pw).once("value", snap=>{
    showSpinner(false);
    if(snap.exists()){
      const data = Object.values(snap.val())[0];
      entryCount++;
      showKey(`${entryCount}. Password: ${pw}\nGet Key: ${data.key}`);
      wrongAttempts=0;
    } else {
      wrongAttempts++;
      showError("‚ùå Password salah!");
      if(wrongAttempts>=3){
        isBlocked=true;
        showError("‚ö†Ô∏è Salah 3x! Tunggu 10 detik...");
        disableInputs(true);
        setTimeout(()=>{isBlocked=false;wrongAttempts=0;disableInputs(false);hideError();},10000);
      }
    }
  });
};

copyBtn.onclick = () => {
  navigator.clipboard.writeText(keyBox.textContent).then(()=>alert("‚úÖ Key disalin!"));
};

togglePwBtn.onclick = () => {
  if(passwordInput.type==="password"){
    passwordInput.type="text"; togglePwBtn.textContent="üôà";
  } else {
    passwordInput.type="password"; togglePwBtn.textContent="üëÅ";
  }
};

buyKeyBtn.onclick = () => window.open("https://t.me/ARullReal","_blank");

adminBtn.onclick = () => {
  const pw = prompt("Masukkan password admin:");
  if(pw!=="RullAdmin") return alert("‚ùå Salah password admin!");
  showAdmin();
};

function showAdmin(){
  adminPanel.style.display="block";
  db.ref("visitorCount").once("value", s=>{
    adminPanel.innerHTML = `üë• Pengunjung: ${s.val()||0}<br>`;
  });
  fetch("https://ipinfo.io?token=7004bb2c0f2233").then(r=>r.json()).then(d=>{
    adminPanel.innerHTML += `üåç IP: ${d.ip}<br>Negara: ${d.country}<br>Kota: ${d.city}<br>Org: ${d.org}<br>`;
  });
  listKeys();
}

function listKeys(){
  db.ref("keys").once("value", s=>{
    adminPanel.innerHTML += "<hr>üîë Key List:<br>";
    s.forEach(c=>{
      const d=c.val();
      adminPanel.innerHTML += `${d.password}:${d.key}<br>`;
    });
  });
}

function showSpinner(s){spinner.style.display=s?"block":"none";}
function showKey(t){keyBox.textContent=t; keyBox.style.display="block"; copyBtn.style.display="block";}
function showError(t){errorBox.textContent=t; errorBox.style.display="block";}
function hideError(){errorBox.style.display="none";}
function disableInputs(b){generateBtn.disabled=b; passwordInput.disabled=b;}
</script>
</body>
</html>
